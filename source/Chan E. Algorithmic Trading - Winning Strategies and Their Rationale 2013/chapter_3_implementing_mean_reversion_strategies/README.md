# 평균 회귀 전략의 실행 (Implementing Mean Reversion Strategies)

### **[발표자료 PDF 다운로드](./Adaptive_Mean_Reversion_Algorithms.pdf)**

## 핵심 요약 (Executive Summary)

본 문서는 자산 가격이 평균으로 회귀하는 성질을 이용한 트레이딩 전략의 실무적 구현 방법을 분석합니다. 주요 분석 결과는 다음과 같습니다.

* **실무적 접근의 필요성**: 이론적인 정체성(Stationarity)이나 공적분(Cointegration)이 완벽하지 않더라도 단기적 또는 계절적 평균 회귀 성향을 이용해 수익 창출이 가능합니다.
* **신호 산출 방식의 다양화**: 가격 스프레드(Price Spreads), 로그 가격 스프레드(Log Price Spreads), 가격 비율(Ratios) 등 다양한 방식으로 트레이딩 신호를 구성할 수 있으며, 각각의 방식은 자산 구성 및 리밸런싱 측면에서 고유한 특성을 가집니다.
* **볼린저 밴드와 실행 최적화**: 단순 선형 전략의 한계를 극복하기 위해 볼린저 밴드를 활용하며, 분할 진입(Scaling-in)보다는 단일 진입(All-in) 방식이 통계적으로 더 높은 수익을 제공할 수 있다는 연구 결과가 존재합니다.
* **칼만 필터(Kalman Filter)의 도입**: 고정된 룩백(Look-back) 기간을 사용하는 기존 방식의 단점을 보완하기 위해, 칼만 필터를 활용하여 헤지 비율과 평균 가격을 동적으로 추정함으로써 전략의 성과를 개선할 수 있습니다.
* **데이터 품질의 중요성**: 평균 회귀 전략은 데이터 오류(Outliers)에 매우 취약하며, 이는 백테스트 결과를 과대포장하거나 실거래에서 손실을 유발하는 주요 원인이 됩니다.

![Figure](unnamed.png)

---

## 1. 포트폴리오 구축 및 트레이딩 신호 산출

평균 회귀 전략을 구현하기 위해서는 먼저 통계적으로 유의미한 트레이딩 신호를 생성해야 합니다. 소스 데이터는 세 가지 주요 방식을 제시합니다.

### 1.1 가격 스프레드 (Price Spreads)

가장 일반적인 방식으로, 두 자산의 가격 차이를 이용합니다.

* **수식**: $y = y_1 - h y_2$ ($h$는 헤지 비율)
* **특징**: 트레이딩 기간 동안 각 자산의 **주식 수(Shares)**를 고정하여 포트폴리오를 구성할 때 적합합니다.

### 1.2 로그 가격 스프레드 (Log Price Spreads)

* **수식**: $log(q) = h_1 log(y_1) + h_2 log(y_2) + \dots$
* **특징**: 트레이딩 기간 동안 각 자산의 자본 가치(Capital Values) 비중을 일정하게 유지하려는 경우 사용합니다. 일정한 자본 가치를 유지하기 위해 지속적인 리밸런싱과 현금 구성 요소의 관리가 필요하므로 실무적으로 더 복잡합니다.

### 1.3 가격 비율 (Ratios)

* **특징**: 통상적으로 외환(FX) 거래에서 널리 사용됩니다. 자산 간에 진정한 공적분 관계가 존재하지 않더라도 단기적인 평균 회귀가 기대될 때 효과적입니다.
* **사례 분석 (GLD-USO)**: 금(GLD)과 원유(USO) ETF를 대상으로 한 테스트 결과, 비율 기반 전략보다는 동적 헤지 비율을 적용한 가격 스프레드 전략이 더 우수한 성과를 보였습니다.

---

## 2. 볼린저 밴드와 실무적 전략 구현

단순 선형 평균 회귀 전략은 무한한 구매력이 필요하고 지속적인 재조정이 요구되는 등 비실용적입니다. 이를 해결하기 위해 볼린저 밴드가 활용됩니다.

### 2.1 전략의 매개변수

* **Entry Z-score**: 평균으로부터 몇 표준편차만큼 벗어났을 때 진입할 것인지 결정합니다.
* **Exit Z-score**: 어느 수준에서 청산할 것인지 결정합니다 (통상 Exit < Entry).
* **Look-back 기간**: 평균과 표준편차를 계산할 과거 데이터의 범위를 설정합니다.

### 2.2 전략 성과 분석 (GLD-USO 사례)

동일한 자산(GLD-USO)에 대해 선형 전략과 볼린저 밴드 전략을 비교한 결과입니다.

| 전략 유형 | 연간 수익률(APR) | 샤프 지수(Sharpe Ratio) |
| --- | --- | --- |
| **선형 평균 회귀 전략** | 10.9% | 0.59 |
| **볼린저 밴드 전략** | 17.8% | 0.96 |

---

## 3. 분할 진입(Scaling-in)의 효율성 논쟁

많은 트레이더가 가격이 평균에서 멀어질수록 투입 자본을 늘리는 분할 진입 방식을 선호하지만, Schoenberg와 Corwin의 연구는 이에 대해 다른 시각을 제공합니다.

* **이론적 결과**: 확률 모델 분석에 따르면, 분할 진입(Average-in)보다는 최적의 단일 지점에서 모든 자금을 투입하는 "All-in" 방식이 백테스트상 더 높은 평균 수익을 창출합니다.
* **실무적 반론**: 실거래에서는 변동성이 일정하지 않으므로, 표본 외(Out-of-sample) 데이터에서는 분할 진입이 더 나은 위험 조정 수익(샤프 지수)을 제공할 수 있습니다. 또한 대규모 거래 시 시장 충격을 줄이는 데 유리합니다.

---

## 4. 칼만 필터(Kalman Filter)를 통한 동적 최적화

칼만 필터는 관찰 가능한 변수(가격)를 바탕으로 숨겨진 변수(헤지 비율, 평균)의 기댓값을 실시간으로 업데이트하는 최적 선형 알고리즘입니다.

### 4.1 칼만 필터의 장점

1. **동적 가중치**: 과거 데이터의 임의적인 차단 없이 최신 데이터에 더 높은 가중치를 부여합니다.
2. **동시 추정**: 헤지 비율($\beta$)뿐만 아니라 스프레드의 이동 평균과 예측 오차의 표준편차를 동시에 생성합니다.
3. **마켓 메이킹 활용**: 거래 규모($T$)에 따라 가격 불확실성($V_e$)을 조정함으로써 자산의 공정 가치를 정교하게 추정할 수 있습니다.

### 4.2 성과 지표 (EWA-EWC 페어 트레이딩)

칼만 필터를 적용한 전략은 매우 우수한 성과를 기록했습니다.

* **APR**: 26.2%
* **Sharpe Ratio**: 2.4

---

## 5. 데이터 오류에 따른 위험 관리

데이터 오류(Bad ticks 또는 Outliers)는 평균 회귀 전략 실행 시 가장 치명적인 위험 요소 중 하나입니다.

* **백테스트 왜곡**: 실제로는 발생하지 않은 급격한 가격 이탈 후 복귀하는 가짜 신호 때문에 백테스트 수익률이 비정상적으로 높게 나타날 수 있습니다. 이는 모멘텀 전략의 성과를 억제하는 것과 대조적입니다.
* **실거래 손실**: 잘못된 호가(Bid/Ask)에 의한 신호 발생 시, 실행 프로그램은 실제 시장 가격이 아닌 허위 가격을 바탕으로 주문을 전송하여 즉각적인 손실을 유발합니다.
* **스프레드 민감도**: 페어 트레이딩과 같은 차익거래 전략은 개별 자산 가격의 차이를 이용하므로, 아주 작은 데이터 오류도 스프레드 계산 시 큰 퍼센트 오차를 만들어냅니다. 따라서 신뢰할 수 있는 데이터 피드(예: Bloomberg 등)의 확보가 필수적입니다.

---

## 결론 및 핵심 포인트 (Key Points)

1. **목적에 따른 신호 선택**: 고정 주식 수 포트폴리오는 가격 스프레드를, 고정 자본 비중 포트폴리오는 로그 가격 스프레드를 사용하십시오.
2. **유연한 대응**: 공적분 관계가 불분명한 자산이나 통화쌍의 경우 가격 비율(Ratio)이 효과적일 수 있습니다.
3. **지표의 동적 업데이트**: 헤지 비율과 평균의 변화에 대응하기 위해 이동 룩백 기간이나 칼만 필터를 적극적으로 활용하십시오.
4. **데이터 무결성 확보**: 데이터 오류는 전략의 수익을 허위로 부풀리거나 실거래에서 막대한 손실을 초래하므로 정교한 데이터 정제(Cleansing)가 선행되어야 합니다.

---

<div align="center">

[< Previous](../chapter_2_the_basics_of_mean_reversion/README.md) | [Table of Contents](../README.md) | [Next >](../chapter_4_mean_reversion_of_stocks_and_etfs/README.md)

</div>
