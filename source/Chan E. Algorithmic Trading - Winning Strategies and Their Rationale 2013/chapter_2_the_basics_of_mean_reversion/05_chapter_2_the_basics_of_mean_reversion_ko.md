# 평균 회귀의 기초 (The Basics of Mean Reversion)

우리가 인식하든 못하든, 자연은 평균 회귀(mean reversion)의 예로 가득 차 있다. 그림 2.1은 서기 622년부터 1284년까지의 나일강 수위를 보여주며, 이는 명백히 평균 회귀하는 시계열이다. 평균 회귀는 사회과학에서도 마찬가지로 널리 퍼져 있다. 다니엘 카너먼(Daniel Kahneman)은 유명한 예를 인용했다: "스포츠 일러스트레이티드 징크스(Sports Illustrated jinx)"는 "잡지 표지에 사진이 실린 운동선수는 다음 시즌에 저조한 성적을 낼 운명"이라는 주장이다(Kahneman, 2011). 과학적 이유는 운동선수의 성적이 평균을 중심으로 무작위로 분포한다고 볼 수 있으므로, 어느 해에 예외적으로 좋은 성적(이로 인해 스포츠 일러스트레이티드 표지에 실리게 됨)을 거두면 그 다음 해에는 평균에 더 가까운 성적을 낼 가능성이 매우 높기 때문이다.

평균 회귀는 금융 가격 시계열에서도 널리 퍼져 있을까? 만약 그렇다면, 트레이더로서 우리의 삶은 매우 단순하고 수익성 있을 것이다! 우리가 해야 할 일은 가격이 평균보다 낮을 때 매수하고, 평균 가격으로 회귀할 때까지 기다린 후, 이 더 높은 가격에 매도하는 것을 하루 종일 반복하기만 하면 된다. 아쉽게도, 대부분의 가격 시계열은 평균 회귀하지 않고 기하 랜덤 워크(geometric random walk)를 따른다. 가격이 아닌 *수익률*이 보통 0의 평균을 중심으로 무작위 분포한다. 불행히도, 우리는 수익률의 평균 회귀를 거래할 수 없다. (수익률의 평균 회귀와 수익률의 역직렬상관(anti-serial-correlation)을 혼동해서는 안 된다. 역직렬상관은 확실히 거래할 수 있다. 하지만 수익률의 역직렬상관은 가격의 평균 회귀와 같은 것이다.) 평균 회귀하는 것으로 밝혀진 소수의 가격 시계열을 *정상성(stationary)*이라고 하며, 이 장에서 정상성에 대한 통계적 검정(ADF 검정, 허스트 지수 및 분산비 검정)을 설명할 것이다. 정상성을 가진

![](_page_1_Figure_2.jpeg)

**그림 2.1** 나일강의 최저 수위, 서기 622-1284년

미리 만들어진(prefabricated) 가격 시계열은 그리 많지 않다. *미리 만들어진*이란 공개 거래소나 시장에서 거래되는 자산을 나타내는 가격 시계열을 의미한다.

다행히도, 거래되는 자산보다 훨씬 더 많은 평균 회귀 가격 시계열을 제조할 수 있다. 왜냐하면 평균 회귀하지 않는 두 개 이상의 개별 가격 시계열을 결합하여 순 시장 가치(즉, 가격)가 평균 회귀하는 포트폴리오를 만들 수 있기 때문이다. 이런 방식으로 결합될 수 있는 가격 시계열을 공적분(cointegrating)이라고 하며, 공적분에 대한 통계적 검정(CADF 검정 및 요한센 검정)도 설명할 것이다. 또한, 요한센 검정의 부산물로서 평균 회귀 포트폴리오를 만들기 위한 각 자산의 정확한 가중치를 결정할 수 있다. 이렇게 인위적으로 정상 포트폴리오를 만들 수 있는 가능성 때문에, 평균 회귀 트레이더에게는 수많은 기회가 있다.

평균 회귀 가격 시계열에서 수익을 내는 것이 얼마나 쉬운지 설명하기 위해, 진정으로 "매개변수가 없는" 간단한 선형 거래 전략도 설명할 것이다.

한 가지 명확히 할 점: 이 장에서 살펴볼 평균 회귀 유형은 *시계열* 평균 회귀라고 할 수 있다. 가격이 자체 과거 가격에 의해 결정된 평균으로 회귀한다고 가정하기 때문이다. 이 장에서 묘사하는 검정과 거래 전략은 모두 시계열 평균 회귀에 맞춰져 있다. 또 다른 종류의 평균 회귀가 있는데, "횡단면(cross-sectional)" 평균 회귀라고 한다. 횡단면 평균 회귀는 바스켓 내 상품들의 누적 수익률이 바스켓의 누적 수익률로 회귀한다는 것을 의미한다. 이는 또한 상품들의 단기 *상대* 수익률이 직렬 역상관되어 있음을 의미한다. (상품의 상대 수익률은 해당 상품의 수익률에서 바스켓의 수익률을 뺀 것이다.) 이 현상은 주식 바스켓에서 가장 자주 발생하므로, 제4장에서 주식과 ETF에 대한 평균 회귀 전략을 논의할 때 이를 활용하는 방법을 다룰 것이다.

## 평균 회귀와 정상성 (Mean Reversion and Stationarity)

평균 회귀와 정상성은 같은 유형의 가격 시계열을 바라보는 두 가지 동등한 방법이지만, 이 두 가지 방법은 그러한 시계열에 대해 두 가지 다른 통계적 검정을 제공한다.

평균 회귀 가격 시계열의 수학적 설명은 다음 기간의 가격 변화가 평균 가격과 현재 가격의 차이에 비례한다는 것이다. 이것이 ADF 검정의 기초가 되며, 비례 상수가 0이라는 귀무가설을 기각할 수 있는지 테스트한다.

그러나 정상 가격 시계열의 수학적 설명은 가격의 로그의 분산이 기하 랜덤 워크보다 느리게 증가한다는 것이다. 즉, 분산은 기하 랜덤 워크의 경우처럼 시간의 선형 함수가 아니라 시간의 부분선형(sublinear) 함수이다. 이 부분선형 함수는 일반적으로 $\tau^{2H}$로 근사되는데, 여기서 $\tau$는 두 가격 측정 사이의 시간 간격이고, $H$는 소위 허스트 지수(Hurst exponent)로서 가격 시계열이 실제로 정상이면 0.5보다 작다(가격 시계열이 기하 랜덤 워크이면 0.5와 같다). 분산비 검정(Variance Ratio test)은 허스트 지수가 실제로 0.5라는 귀무가설을 기각할 수 있는지 확인하는 데 사용할 수 있다.

정상성(stationarity)은 약간 잘못된 명칭이라는 점에 유의하라: 이것은 가격이 반드시 범위 제한되어 있고, 시간에 독립적인 분산을 가지며 따라서 허스트 지수가 0이라는 것을 의미하지 않는다. 단지 분산이 정상 확산보다 느리게 증가한다는 것을 의미할 뿐이다.

ADF 및 분산비 검정에 대한 명확한 수학적 설명은 월터 베케르트(Walter Beckert)의 강의 노트에서 찾을 수 있다(Beckert, 2011). 여기서는 실용적인 거래 전략에 대한 적용에만 관심이 있다.

## 확장 디키-풀러 검정 (Augmented Dickey-Fuller Test)

가격 시계열이 평균 회귀하면, 현재 가격 수준은 가격의 다음 움직임이 무엇일지에 대해 알려줄 것이다: 가격 수준이 평균보다 높으면 다음 움직임은 하락할 것이고; 가격 수준이 평균보다 낮으면 다음 움직임은 상승할 것이다. ADF 검정은 바로 이 관찰에 기반한다.

가격 변화를 선형 모델로 설명할 수 있다:

$$\Delta y(t) = \lambda y(t-1) + \mu + \beta t + \alpha_1 \Delta y(t-1) + \dots + \alpha_k \Delta y(t-k) + \epsilon_t \qquad (2.1)$$

여기서 $\Delta y(t) \equiv y(t) - y(t - 1)$, $\Delta y(t - 1) \equiv y(t - 1) - y(t - 2)$ 등이다. ADF 검정은 $\lambda = 0$인지 알아낼 것이다. 만약 $\lambda = 0$이라는 가설이 기각될 수 있다면, 이는 다음 움직임 $\Delta y(t)$가 현재 수준 $y(t - 1)$에 의존한다는 것을 의미하며, 따라서 랜덤 워크가 아니다. 검정 통계량은 회귀 계수 $\lambda$(독립 변수로 $y(t - 1)$, 종속 변수로 $\Delta y(t)$)를 회귀 적합의 표준 오차로 나눈 것이다: $\lambda/\text{SE}(\lambda)$. 통계학자 디키와 풀러(Dickey and Fuller)가 친절하게도 이 검정 통계량의 분포를 찾아 임계값을 표로 만들어 두었으므로, 어떤 $\lambda/\text{SE}(\lambda)$ 값에 대해서도 가설이 예를 들어 95% 확률 수준에서 기각될 수 있는지 찾아볼 수 있다.

평균 회귀를 기대하므로 $\lambda/\text{SE}(\lambda)$는 음수여야 하고, 가설이 기각되려면 임계값보다 더 음수여야 한다는 점에 주목하라. 임계값 자체는 표본 크기와 가격 시계열이 0이 아닌 평균 $-\mu/\lambda$를 가지는지 또는 일정한 추세 $-\beta t/\lambda$를 가지는지에 따라 달라진다. 실제 거래에서 가격의 일정한 추세가 있더라도 일일 가격 변동보다 훨씬 작은 규모인 경향이 있다. 따라서 단순화를 위해 이 추세 항을 0으로 가정할 것이다($\beta = 0$).

예제 2.1에서 통화 환율 시계열 USD.CAD에 ADF 검정을 적용한다.

#### 예제 2.1: 평균 회귀에 ADF 검정 사용하기 (Example 2.1: Using ADF Test for Mean Reversion)

ADF 검정은 MATLAB Econometrics 함수 *adftest*로 사용 가능하거나, 오픈 소스 MATLAB 패키지 spatial-econometrics.com의 *adf* 함수로 사용 가능하다. 아래에서는 *adf*를 사용할 것이며, 내 코드는 [http://epchan.com/book2](http://epchan.com/book2)에서 *stationarityTests.m*으로 다운로드할 수 있다.

(spatial-econometrics.com의 jplv7 폴더를 컴퓨터에 다운로드한 후, 사용하기 전에 이 패키지의 모든 하위 폴더를 MATLAB 경로에 추가하는 것을 잊지 마라.)

#### 예제 2.1 (계속)

*adf* 함수에는 세 가지 입력이 있다. 첫 번째는 시간 오름차순(시간 순서가 중요함)으로 된 가격 시계열이다. 두 번째는 식 2.1에서 오프셋 μ를 가정해야 하는지, 추세 β가 0이어야 하는지를 나타내는 매개변수이다. 가격이 회귀하는 평균 가격이 0인 경우는 드물기 때문에 오프셋은 0이 아니라고 가정해야 한다. 그러나 가격의 일정한 추세는 일일 가격 변동보다 훨씬 작은 규모인 경향이 있으므로 추세는 0이라고 가정해야 한다. 이러한 고려 사항은 두 번째 매개변수가 0이어야 함을 의미한다(패키지 설계자의 규칙에 따라). 세 번째 입력은 시차(lag) *k*이다. $k$ = 0으로 시작해 볼 수 있지만, 종종 $k$ = 1로 설정해야만 귀무가설을 기각할 수 있는데, 이는 가격 변화가 종종 직렬 상관관계를 가지기 때문이다. 환율 USD.CAD(1 미국 달러와 교환되는 캐나다 달러 수)에 대해 검정을 시도할 것이다. 17:00 ET의 일일 가격이 MATLAB 배열 γ에 저장되어 있다고 가정한다. 데이터 파일은 1분봉이지만, 17:00 ET의 장 마감 가격만 추출할 것이다. 일중 빈도로 데이터를 샘플링해도 ADF 검정의 통계적 유의성은 증가하지 않는다. 그림 2.2에서 볼 수 있듯이 그다지 정상적으로 보이지 않는다.

![](_page_4_Figure_4.jpeg)

**그림 2.2** USD.CAD 가격 시계열

#### 예제 2.1 (계속)

그리고 실제로, ADF 검정 통계량이 약 -1.84임을 확인할 수 있지만, 90% 수준의 임계값은 -2.594이므로 $\lambda$가 0이라는 가설을 기각할 수 없다. 즉, USD.CAD가 정상이라는 것을 보여줄 수 없는데, 캐나다 달러는 원자재 통화로 알려져 있고 미국 달러는 그렇지 않기 때문에 이는 놀라운 일이 아닐 수 있다. 그러나 $\lambda$가 음수라는 점에 주목하라. 이는 가격 시계열이 적어도 추세를 보이지는 않는다는 것을 나타낸다.

```text
results=adf(y, 0, 1);
prt(results);
% Augmented DF test for unit root variable: variable 1
% ADF t-statistic # of lags AR(1) estimate
% -1.840744 1 0.994120
%
% 1% Crit Value 5% Crit Value 10% Crit Value
% -3.458 -2.871 -2.594
```

## 허스트 지수와 분산비 검정 (Hurst Exponent and Variance Ratio Test)

직관적으로 말하면, "정상" 가격 시계열은 가격이 초기 값에서 기하 랜덤 워크보다 더 느리게 확산된다는 것을 의미한다. 수학적으로, 이 확산 속도를 측정하여 가격 시계열의 성격을 결정할 수 있다. 확산 속도는 분산으로 특성화될 수 있다:

$$\text{Var}(\tau) = \langle |z(t+\tau) - z(t)|^2 \rangle \qquad (2.2)$$

여기서 $z$는 로그 가격($z = \text{log}(y)$)이고, $\tau$는 임의의 시간 지연이며, $\langle \dots \rangle$는 모든 $t$에 대한 평균이다. 기하 랜덤 워크의 경우, 다음을 알고 있다:

$$\langle |z(t+\tau) - z(t)|^2 \rangle \sim \tau \qquad (2.3)$$

$\sim$는 이 관계가 큰 $\tau$에 대해 어떤 비례 상수와 함께 등식이 되지만, 작은 $\tau$에 대해서는 직선에서 벗어날 수 있음을 의미한다. 그러나 (로그) 가격 시계열이 평균 회귀하거나 추세를 보인다면(즉, 순차적인 가격 움직임 사이에 양의 상관관계가 있다면), 식 2.3은 성립하지 않는다. 대신, 다음과 같이 쓸 수 있다:

$$\langle |z(t+\tau) - z(t)|^2 \rangle \sim \tau^{2H} \qquad (2.4)$$

여기서 허스트 지수 $H$를 정의했다. 기하 랜덤 워크를 보이는 가격 시계열의 경우 $H = 0.5$이다. 그러나 평균 회귀 시계열의 경우 $H < 0.5$이고, 추세 시계열의 경우 $H > 0.5$이다. $H$가 0을 향해 감소할수록 가격 시계열은 더 평균 회귀하고, $H$가 1을 향해 증가할수록 가격 시계열은 점점 더 추세를 보인다. 따라서 $H$는 평균 회귀 또는 추세 정도의 지표 역할도 한다.

예제 2.2에서는 MATLAB 코드를 사용하여 이전 섹션에서 사용한 것과 동일한 통화 환율 시계열 USD.CAD에 대한 허스트 지수를 계산했다. 0.49의 H가 생성되며, 이는 가격 시계열이 약하게 평균 회귀함을 시사한다.

#### 예제 2.2: 허스트 지수 계산하기 (Example 2.2: Computing the Hurst Exponent)

이전 예제와 동일한 USD.CAD 가격 시계열을 사용하여, MATLAB Central(www.mathworks.com/matlabcentral/fileexchange/30076-generalized-hurst-exponent)에서 다운로드할 수 있는 *genhurst* 함수를 사용해 허스트 지수를 계산한다. 이 함수는 $\langle |z(t+\tau)-z(t)|^{2q} \rangle \sim \tau^{2H(q)}$로 정의되는 일반화된 버전의 허스트 지수를 계산하며, 여기서 $q$는 임의의 숫자이다. 그러나 여기서는 $q=2$에만 관심이 있으며, 이를 *genhurst*의 두 번째 입력 매개변수로 지정한다.

```matlab
H=genhurst(log(y), 2);
```

이 함수를 USD.CAD에 적용하면 $H = 0.49$를 얻으며, 이는 약하게 평균 회귀할 수 있음을 나타낸다.

유한한 표본 크기 때문에, H가 실제로 0.5라는 귀무가설을 기각할 수 있는지 확인하기 위해 추정된 H 값의 통계적 유의성을 알아야 한다. 이 가설 검정은 분산비 검정(Variance Ratio test)에 의해 제공된다(Lo and MacKinlay, 2001).

분산비 검정은 단순히 다음이 1과 같은지 검정한다:

$$\frac{\text{Var}(z(t)-z(t-\tau))}{\tau \text{Var}(z(t)-z(t-1))}$$

이를 위해 미리 만들어진 MATLAB Econometrics Toolbox 함수 *vratiotest*가 있으며, 예제 2.3에서 그 사용법을 보여준다.

#### 예제 2.3: 정상성을 위한 분산비 검정 사용하기 (Example 2.3: Using the Variance Ratio Test for Stationarity)

MATLAB Econometric Toolbox의 *vratiotest*는 이 장의 이전 예제에서 사용된 것과 동일한 USD.CAD 가격 시계열 *y*에 적용된다. 출력은 *h*와 *pValue*이다: $h$ = 1은 90% 신뢰 수준에서 랜덤 워크 가설의 기각을 의미하고, $h$ = 0은 랜덤 워크일 수 있음을 의미한다. *pValue*는 귀무가설(랜덤 워크)이 참일 확률을 제공한다.

```matlab
[h,pValue]=vratiotest(log(y));
```

USD.CAD의 경우 $h$ = 0이고 *pValue* = 0.367281임을 확인할 수 있는데, 이는 랜덤 워크일 확률이 37%임을 나타내므로 이 가설을 기각할 수 없다.

## 평균 회귀의 반감기 (Half-Life of Mean Reversion)

평균 회귀 또는 정상성에 대해 설명한 통계적 검정은 최소 90%의 확실성을 요구하기 때문에 매우 까다롭다. 그러나 실제 거래에서는 훨씬 낮은 확실성으로도 종종 수익을 낼 수 있다. 이 섹션에서는 식 2.1의 λ 계수를 해석하는 또 다른 방법을 찾아, ADF 검정에서 90% 확률로 실제 값이 0이라는 귀무가설을 기각할 수 없더라도 거래 전략을 실용적으로 만들기에 충분히 음수인지 알 수 있게 할 것이다. λ가 가격이 평균 회귀하는 데 걸리는 시간의 척도라는 것을 알게 될 것이다.

이 새로운 해석을 드러내기 위해, 이산 시계열 식 2.1을 미분 형태로 변환하여 가격의 변화가 무한소량이 되도록 하기만 하면 된다. 또한, 식 2.1에서 추세($\beta t$)와 지연 차분($\Delta y(t - 1), \dots, \Delta y(t - k)$)을 무시하면, 확률 미적분학에서 평균 회귀 과정에 대한 오른스타인-울렌벡(Ornstein-Uhlenbeck) 공식으로 인식할 수 있게 된다:

$$dy(t) = (\lambda y(t-1) + \mu)dt + d\varepsilon \qquad (2.5)$$

여기서 $d\varepsilon$는 가우시안 노이즈이다. 2.1의 이산 형태에서 $\Delta y(t)$를 $y(t - 1)$에 대해 선형 회귀하면 $\lambda$를 얻게 되며, 일단 결정되면 이 $\lambda$ 값은 2.5의 미분 형태로 이어진다. 그러나 방정식을 미분 형태로 쓰는 것의 장점은 $y(t)$의 기댓값에 대한 해석해를 허용한다는 것이다:

$$E(y(t)) = y_0 \exp(\lambda t) - \frac{\mu}{\lambda} (1 - \exp(\lambda t)) \qquad (2.6)$$

평균 회귀 과정에서 $\lambda$가 음수라는 것을 기억하면, 이는 가격의 기댓값이 감쇠 반감기가 $-\text{log}(2)/\lambda$인 값 $-\mu/\lambda$로 지수적으로 감쇠함을 알려준다. 회귀 계수 $\lambda$와 평균 회귀의 반감기 사이의 이 연결은 트레이더에게 매우 유용하다. 첫째, $\lambda$가 양수라면 가격 시계열이 전혀 평균 회귀하지 않으므로 평균 회귀 전략으로 거래하려고 시도조차 해서는 안 된다. 둘째, $\lambda$가 0에 매우 가깝다면 반감기가 매우 길어서 평균 회귀 거래 전략이 그다지 수익성이 없을 것이다. 주어진 기간에 많은 왕복 거래를 완료할 수 없기 때문이다. 셋째, 이 $\lambda$는 전략의 많은 매개변수에 대한 자연스러운 시간 척도도 결정한다. 예를 들어, 반감기가 20일이면 평균 회귀 전략에 5일의 룩백(look-back)을 사용해서 이동 평균이나 표준 편차를 계산해서는 안 된다. 종종 룩백을 반감기의 작은 배수로 설정하는 것이 최적에 가깝고, 그렇게 하면 거래 전략의 성과에 기반한 자유 매개변수의 무차별 최적화를 피할 수 있다. 예제 2.4에서 반감기 계산 방법을 보여줄 것이다.

#### 예제 2.4: 평균 회귀의 반감기 계산하기 (Example 2.4: Computing Half-Life for Mean Reversion)

이전 예제에서 USD.CAD 가격 시계열이 최소 90% 확률로 정상이 아니라고 결론지었다. 그러나 이것이 반드시 평균 회귀 모델을 사용하여 이 가격 시계열 거래를 포기해야 한다는 것을 의미하지는 않는다. 왜냐하면 대부분의 수익성 있는 거래 전략은 그렇게 높은 수준의 확실성을 요구하지 않기 때문이다. USD.CAD가 평균 회귀 거래에 적합한 후보인지 결정하기 위해 이제 평균 회귀의 반감기를 결정할 것이다.

식 2.1과 2.5에서 $\lambda$를 결정하기 위해 $y(t) - y(t - 1)$을 종속 변수로, $y(t - 1)$을 독립 변수로 하여 회귀 적합을 실행할 수 있다. 회귀 함수 *ols*와 함수 *lag*는 모두 jplv7 패키지의 일부이다. (이를 위해 MATLAB Statistics Toolbox *regress* 함수도 사용할 수 있다.)

#### 예제 2.4 (계속)

이 코드 조각은 *stationaryTests.m*의 일부이다.

```matlab
ylag=lag(y, 1); % lag is a function in the jplv7
 % (spatial-econometrics.com) package.
deltaY=y-ylag;
deltaY(1)=[]; % Regression functions cannot handle the NaN
 in the first bar of the time series.
ylag(1)=[];
regress_results=ols(deltaY, [ylag ones(size(ylag))]);
halflife=-log(2)/regress_results.beta(1);
```

결과는 약 115일이다. 거래 기간에 따라 이것이 너무 길 수도 있고 아닐 수도 있다. 그러나 적어도 어떤 룩백을 사용해야 하고 어떤 보유 기간을 기대해야 하는지 알게 된다.

## 선형 평균 회귀 거래 전략 (A Linear Mean-Reverting Trading Strategy)

가격 시계열이 평균 회귀하고, 가격 시계열의 평균 회귀 반감기가 우리 거래 기간에 충분히 짧다고 결정하면, 간단한 선형 전략을 사용하여 이 가격 시계열에서 쉽게 수익을 낼 수 있다: 가격의 이동 평균에서 정규화된 편차(가격의 이동 표준 편차로 나눈 것)를 결정하고, 이 정규화된 편차에 음의 비례로 자산의 단위 수를 유지한다. 이동 평균과 표준 편차의 룩백은 반감기와 같게 설정할 수 있다. 예제 2.5에서 USD.CAD에 대해 이 선형 평균 회귀가 어떻게 작동하는지 살펴본다.

평균 회귀 전략에 이동 평균이나 표준 편차를 사용해야 하는 이유가 무엇인지 궁금할 수 있다. 가격 시계열이 정상이면 평균과 표준 편차가 영원히 고정되어야 하지 않을까? 일반적으로 가격 시계열의 평균이 고정되어 있다고 가정하지만, 실제로는 경제나 기업 경영의 변화로 인해 천천히 변할 수 있다. 표준 편차의 경우, 식 2.4는 $0 < H < 0.5$인 "정상" 가격 시계열조차도 시간에 따라 증가하는 분산을 가지지만, 기하 랜덤 워크만큼 빠르지는 않다는 것을 암시한다. 따라서 항상 진화하는 평균과 표준 편차에 적응하고, 더 빠르게 수익을 포착하기 위해 이동 평균과 표준 편차를 사용하는 것이 적절하다. 이 점은 제3장에서 특히 "스케일링 인(scaling-in)"의 맥락에서 더 철저히 탐구할 것이다.

#### 예제 2.5: 선형 평균 회귀 거래 전략 백테스팅하기 (Example 2.5: Backtesting a Linear Mean-Reverting Trading Strategy)

이 간단한 전략에서 우리는 USD.CAD의 이동 평균에서 음의 정규화된 편차와 같은 수의 USD.CAD 단위를 보유하려고 한다. 통화쌍 USD.X의 한 단위의 시장 가치(USD 기준)는 USD.X 시세에 불과하므로, 이 경우 선형 평균 회귀는 포트폴리오의 시장 가치를 USD.CAD의 Z-점수의 음수로 설정하는 것과 같다. *movingAvg* 및 *movingStd* 함수는 내 웹사이트에서 다운로드할 수 있다. (이 코드 조각은 *stationaryTests.m*의 일부이다.)

```matlab
lookback=round(halflife); % setting lookback to the halflife
 % found above
mktVal=-(y-movingAvg(y, lookback))./movingStd(y, lookback);
pnl=lag(mktVal, 1).*(y-lag(y, 1))./lag(y, 1); % daily P&L of
 % the strategy
```

이 전략의 누적 손익(P&L)은 그림 2.3에 표시되어 있다.

긴 반감기에도 불구하고, 총 손익(P&L)은 큰 드로다운이 있긴 하지만 양수를 유지한다. 이 책의 대부분의 예제 전략과 마찬가지로, 거래 비용은 포함하지 않았다. 또한, 이 특정 예제에는 인샘플 데이터를 사용하여 반감기와 따라서 룩백을 찾았기 때문에

![](_page_10_Figure_7.jpeg)

**그림 2.3** AUDCAD에 대한 선형 거래 전략의 자산 곡선

#### 예제 2.5 (계속)

미래 예측 편향(look-ahead bias)이 관련되어 있다. 또한, 포트폴리오의 시장 가치에 최대치를 부과하지 않았기 때문에 손익을 생성하기 위해 무제한의 자본이 필요할 수 있다. 따라서 실용적인 거래 전략으로 확실히 추천하지 않는다. (제5장에 이 평균 회귀 전략의 더 실용적인 버전이 있다.) 그러나 비정상 가격 시계열이 평균 회귀 전략 거래를 단념하게 해서는 안 되며, 평균 회귀 시계열에서 수익을 추출하기 위해 매우 복잡한 전략이나 기술적 지표가 필요하지 않다는 것을 보여준다.

트레이더의 목표가 궁극적으로 평균 회귀 거래 전략의 기대 수익률이나 샤프 비율이 충분히 좋은지 결정하는 것이라면, 왜 정상성 검정(ADF 또는 분산비)과 반감기 계산을 거치는 수고를 해야 할까? 거래 전략에 대해 직접 백테스트를 실행하고 끝내면 안 될까? 이러한 예비 검정을 거친 이유는 그들의 통계적 유의성이 일반적으로 거래 전략의 직접 백테스트보다 높기 때문이다. 이러한 예비 검정은 매일의(또는 더 일반적으로 매 봉의) 가격 데이터를 검정에 활용하는 반면, 백테스트는 일반적으로 성과 통계를 수집하기 위해 상당히 적은 수의 왕복 거래를 생성한다. 또한, 백테스트의 결과는 특정 거래 매개변수 세트를 가진 거래 전략의 세부 사항에 의존한다. 그러나 정상성 통계 검정을 통과한 가격 시계열, 또는 적어도 충분히 짧은 반감기를 가진 가격 시계열이 주어지면, 비록 백테스트한 것은 아니더라도 결국 수익성 있는 거래 전략을 찾을 수 있다고 확신할 수 있다.

## 공적분 (Cointegration)

이 장의 서론에서 언급했듯이, 대부분의 금융 가격 시계열은 정상이거나 평균 회귀하지 않는다. 그러나 다행히도 우리는 "미리 만들어진" 금융 가격 시계열만 거래하는 데 국한되지 않는다: 포트폴리오의 시장 가치(또는 가격) 시계열이 정상이 되도록 개별 가격 시계열의 포트폴리오를 적극적으로 만들 수 있다. 이것이 공적분(cointegration)의 개념이다: 여러 비정상 가격 시계열의 정상 선형 결합을 찾을 수 있다면, 이 가격 시계열은 *공적분*이라고 한다. 가장 일반적인 결합은 두 가격 시계열의 결합이다: 한 자산을 매수하면서 동시에 다른 자산을 매도하고, 각 자산에 적절한 자본 배분을 한다. 이것이 익숙한 "페어 트레이딩(pairs trading)" 전략이다. 그러나 공적분 개념은 세 개 이상의 자산으로 쉽게 확장된다. 이 섹션에서는 두 가지 일반적인 공적분 검정인 CADF 및 요한센 검정을 살펴볼 것이다. 전자는 한 쌍의 가격 시계열에만 적합하고, 후자는 임의 개수의 시계열에 적용 가능하다.

### 공적분 확장 디키-풀러 검정 (Cointegrated Augmented Dickey-Fuller Test)

호기심 많은 독자는 다음과 같은 질문을 할 수 있다: 포트폴리오 가격 시계열의 정상성에 대해 믿을 수 있는 ADF 및 분산비 검정이 이미 있는데, 왜 새로운 검정이 필요한가? 대답은 여러 가격 시계열이 주어졌을 때, 정상 포트폴리오를 형성하기 위해 어떤 헤지 비율을 사용해야 하는지 *사전에* 알지 못한다는 것이다. (특정 자산의 헤지 비율은 포트폴리오에서 해당 자산을 롱 또는 숏해야 하는 단위 수이다. 자산이 주식이라면 단위 수는 주식 수에 해당한다. 음의 헤지 비율은 해당 자산을 숏해야 함을 나타낸다.) 가격 시계열 세트가 공적분한다고 해서 이들의 *임의의* 무작위 선형 결합이 정상 포트폴리오를 형성한다는 것을 의미하지는 않는다. 그러나 이 사고방식을 더 추구하면, 먼저 두 가격 시계열 사이에 선형 회귀 적합을 실행하여 최적의 헤지 비율을 결정하고, 이 헤지 비율을 사용하여 포트폴리오를 형성한 다음, 마지막으로 이 포트폴리오 가격 시계열에 정상성 검정을 실행하면 어떨까? 이것이 본질적으로 엥글과 그레인저(Engle and Granger)(1987)가 한 것이다. 편의를 위해 spatial-econometrics.com jplv7 패키지는 이러한 모든 단계를 수행하는 *cadf* 함수를 제공한다. 예제 2.6은 두 상장지수펀드(ETF) EWA와 EWC에 적용하여 이 함수를 사용하는 방법을 보여준다.

#### 예제 2.6: 공적분에 CADF 검정 사용하기 (Example 2.6: Using the CADF Test for Cointegration)

ETF는 공적분 가격 시계열을 찾기 위한 비옥한 토양을 제공하므로 페어 트레이딩의 좋은 후보이다. 예를 들어, 캐나다와 호주 경제는 모두 원자재 기반이므로 공적분할 것 같다. *cointegrationTest.m* 프로그램은 내 웹사이트에서 다운로드할 수 있다. EWA의 가격 시계열은 (*계속*)

#### 예제 2.6 (계속)

![](_page_13_Figure_2.jpeg)

**그림 2.4** EWA 대 EWC 주가

배열 *x*에 포함되어 있고, EWC는 배열 *y*에 포함되어 있다고 가정한다. 그림 2.4에서 볼 수 있듯이 상당히 공적분하는 것처럼 보인다.

그림 2.5의 EWA 대 EWC 산점도는 가격 쌍이 직선 위에 떨어지므로 더욱 설득력 있다.

jplv7 패키지에 있는 *ols* 함수를 사용하여 최적의 헤지 비율을 찾을 수 있다.

![](_page_13_Figure_7.jpeg)

**그림 2.5** EWA 대 EWC 산점도

#### 예제 2.6 (계속)

```matlab
regression_result=ols(y, [x ones(size(x))]);
hedgeRatio=regression_result.beta(1);
```

예상대로, 그림 2.6의 잔차 EWC-hedgeRatio*EWA 플롯은 매우 정상적으로 보인다.

검정을 위해 jplv7 패키지의 *cadf* 함수를 사용한다. 두 번째 가격 시계열에 대한 추가 입력 외에 입력은 *adf* 함수와 동일하다. 우리는 다시 페어 포트폴리오의 가격 시계열에 0이 아닌 오프셋이 있을 수 있지만 추세는 0이라고 가정한다. 회귀와 CADF 검정 모두에서 EWA를 독립 변수 *x*로, EWC를 종속 변수 *y*로 선택했다는 점에 유의하라. EWA와 EWC의 역할을 바꾸면 CADF 검정 결과가 달라질까? 불행히도 대답은 "예"이다. EWC를 독립 변수로 선택하여 도출한 헤지 비율은 EWA를 독립 변수로 선택하여 도출한 것의 정확한 역수가 아닐 것이다. 많은 경우(EWA-EWC의 경우는 아니지만, 나중에 요한센 검정으로 확인할 것임) 이러한 헤지 비율 중 하나만이 "올바른" 것인데, 하나의 헤지 비율만이 정상 포트폴리오로 이끈다는 의미이다. CADF 검정을 사용한다면

![](_page_14_Figure_6.jpeg)

**그림 2.6** EWA 대 EWC 간 선형 회귀 잔차의 정상성

#### 예제 2.6 (계속)

각 변수를 독립 변수로 시도하고 어떤 순서가 가장 좋은(가장 음수인) *t*-통계량을 제공하는지 확인한 다음, 그 순서를 사용하여 헤지 비율을 얻어야 한다. 간결함을 위해 EWA가 독립 변수라고 가정하고 CADF 검정을 실행할 것이다.

```matlab
results=cadf(y, x, 0, 1);
% Print out results
prt(results);
% Output:
% Augmented DF test for co-integration variables:
  % variable 1,variable 2
% CADF t-statistic # of lags AR(1) estimate
% -3.64346635 1 -0.020411
%
% 1% Crit Value 5% Crit Value 10% Crit Value
% -3.880 -3.359 -3.038
% -3.880 -3.359 -3.038
```

ADF 검정 통계량이 약 -3.64로, 95% 수준의 임계값 -3.359보다 확실히 더 음수임을 확인할 수 있다. 따라서 $\lambda$가 0이라는 귀무가설을 기각할 수 있다. 다시 말해, EWA와 EWC는 95% 확실성으로 공적분한다.

### 요한센 검정 (Johansen Test)

두 개 이상의 변수에 대한 공적분을 검정하려면 요한센 검정을 사용해야 한다. 이 검정을 이해하기 위해 식 2.1을 가격 변수 $y(t)$가 실제로 여러 가격 시계열을 나타내는 벡터이고, 계수 $\Lambda$와 $A$가 실제로 행렬인 경우로 일반화하자. (정상 포트폴리오 가격에 일정한 추세를 허용하는 것이 실용적이지 않다고 생각하므로, 단순화를 위해 $\beta t = 0$을 가정할 것이다.) 영문 및 그리스 대문자를 사용하여 벡터와 행렬을 각각 나타내면, 식 2.1을 다음과 같이 다시 쓸 수 있다:

$$\Delta Y(t) = \Lambda Y(t-1) + M + A_1 \Delta Y(t-1) + \dots + A_k \Delta Y(t-k) + \epsilon_t \qquad (2.7)$$

단변량 경우와 마찬가지로, $\Lambda = 0$이면 공적분이 없다. ($Y$의 다음 움직임이 현재 가격 수준에 의존하지 않으면 평균 회귀가 있을 수 없음을 상기하라.) $\Lambda$의 랭크(이 기이한 선형대수 용어를 기억하라!)를 $r$로, 가격 시계열의 수를 $n$으로 표기하자. 공적분 가격 시계열의 다양한 선형 결합으로 형성될 수 있는 독립 포트폴리오의 수는 $r$과 같다. 요한센 검정은 $\Lambda$의 고유벡터 분해에 기반한 두 가지 다른 방법으로 $r$을 계산해 줄 것이다. 하나의 검정은 소위 트레이스 통계량(trace statistic)을 생성하고, 다른 하나는 아이겐 통계량(eigen statistic)을 생성한다. (좋은 설명은 Sorensen, 2005에서 찾을 수 있다.) 우리는 그것이 정확히 무엇인지 걱정할 필요가 없다. jplv7 패키지가 각 통계량에 대한 임계값을 제공하여 $r = 0$(공적분 관계 없음), $r \le 1$, ..., $r \le n - 1$까지의 귀무가설을 기각할 수 있는지 검정할 수 있게 해주기 때문이다. 이러한 가설이 모두 기각되면 분명히 $r = n$이다. 유용한 부산물로, 발견된 고유벡터를 정상 포트폴리오를 형성하기 위한 개별 가격 시계열의 헤지 비율로 사용할 수 있다. 예제 2.7에서 EWA-EWC 쌍에 대해 이 검정을 실행하는 방법을 보여주며, 요한센 검정이 이 쌍이 공적분한다는 CADF 검정의 결론을 확인함을 알게 된다. 그러나 더 흥미롭게도, 믹스에 또 다른 ETF를 추가한다: 천연 자원 주식으로 구성된 ETF인 IGE. 이 세 가격 시계열에서 얼마나 많은 공적분 관계를 찾을 수 있는지 살펴볼 것이다. 또한 고유벡터를 사용하여 정상 포트폴리오를 형성하고 평균 회귀의 반감기를 알아낸다.

#### 예제 2.7: 공적분에 요한센 검정 사용하기 (Example 2.7: Using the Johansen Test for Cointegration)

예제 2.6에서 사용한 EWA 및 EWC 가격 시계열을 가져와 요한센 검정을 적용한다. jplv7 패키지의 *johansen* 함수에는 세 가지 입력이 있다: $y$ $p$ $k$ *y*는 입력 행렬로, 각 열 벡터가 하나의 가격 시계열을 나타낸다. ADF 및 CADF 검정과 마찬가지로 $p=0$으로 설정하여 식 2.7이 상수 오프셋($M \ne 0$)을 갖도록 허용하지만 상수 추세 항은 허용하지 않는다($\beta = 0$). 입력 *k*는 시차 수로, 다시 1로 설정한다. (이 코드 조각은 *cointegrationTests.m*의 일부이다.)

```matlab
% Combine the two time series into a matrix y2 for input
 % into Johansen test
y2=[y, x];
results=johansen(y2, 0, 1);
% Print out results
prt(results);
```

#### 예제 2.7 (계속)

```text
% Output: Johansen MLE estimates
NULL: Trace Statistic Crit 90% Crit 95% Crit 99%
r <= 0 variable 1 19.983 13.429 15.494 19.935
r <= 1 variable 2 3.983 2.705 3.841 6.635
NULL: Eigen Statistic Crit 90% Crit 95% Crit 99%
r <= 0 variable 1 16.000 12.297 14.264 18.520
r <= 1 variable 2 3.983 2.705 3.841 6.635
```

트레이스 통계량 검정에서 $r = 0$ 가설이 99% 수준에서 기각되고, $r \le 1$은 95% 수준에서 기각됨을 알 수 있다. 아이겐 통계량 검정은 $r = 0$ 가설이 95% 수준에서 기각되고, $r \le 1$도 95%에서 기각된다고 결론짓는다. 이는 두 검정 모두에서 EWA와 EWC 사이에 두 개의 공적분 관계가 있다고 결론 내린다는 것을 의미한다.

두 가격 시계열만 있을 때 두 개의 공적분 관계를 갖는다는 것은 무슨 의미일까? EWA와 EWC 사이에 자본을 배분하여 정상 포트폴리오를 형성하는 헤지 비율이 하나뿐이지 않을까? 실제로 그렇지 않다. CADF 검정을 논의할 때 순서에 의존한다고 지적했음을 기억하라. EWA의 역할을 독립 변수에서 종속 변수로 바꾸면 다른 결론을 얻을 수 있다. 마찬가지로, EWA를 EWC에 대한 회귀에서 종속 변수로 사용할 때와 EWA를 독립 변수로 사용할 때 다른 헤지 비율을 얻게 된다. 이 두 가지 다른 헤지 비율(반드시 서로의 역수가 아닌)은 두 개의 독립적인 정상 포트폴리오를 형성할 수 있게 해준다. 요한센 검정에서는 이러한 포트폴리오를 얻기 위해 회귀를 두 번 실행할 필요가 없다: 한 번 실행하면 존재하는 모든 독립적인 공적분 관계를 생성한다. 요한센 검정은, 다시 말해, 가격 시계열의 순서에 독립적이다.

이제 포트폴리오에 또 다른 ETF를 도입하자: 천연 자원 주식으로 구성된 IGE. 가격 시계열이 배열 *z*에 포함되어 있다고 가정하고, 세 가격 시계열 모두에 요한센 검정을 실행하여 이 트리오에서 얼마나 많은 공적분 관계를 얻을 수 있는지 알아볼 것이다.

#### 예제 2.7 (계속)

```matlab
y3=[y2, z];
results=johansen(y3, 0, 1);
% Print out results
prt(results);
% Output:
% Johansen MLE estimates
% NULL: Trace Statistic Crit 90% Crit 95% Crit 99%
% r <= 0 variable 1 34.429 27.067 29.796 35.463
% r <= 1 variable 2 17.532 13.429 15.494 19.935
% r <= 2 variable 3 4.471 2.705 3.841 6.635
%
% NULL: Eigen Statistic Crit 90% Crit 95% Crit 99%
% r <= 0 variable 1 16.897 18.893 21.131 25.865
% r <= 1 variable 2 13.061 12.297 14.264 18.520
% r <= 2 variable 3 4.471 2.705 3.841 6.635
```

트레이스 통계량과 아이겐 통계량 검정 모두 95% 확실성으로 세 개의 공적분 관계가 있어야 한다고 결론짓는다.

고유값과 고유벡터는 각각 배열 *results.eig*와 *results.evec*에 포함되어 있다.

```matlab
results.eig % Display the eigenvalues
```

```text
% ans =
%
% 0.0112
% 0.0087
% 0.0030
results.evec % Display the eigenvectors
% ans =
%
% -1.0460 -0.5797 -0.2647
% 0.7600 -0.1120 -0.0790
% 0.2233 0.5316 0.0952
```

고유벡터(*results.evec*에서 열 벡터로 표현됨)가 해당 고유값의 내림차순으로 정렬되어 있음에 주목하라. 따라서 첫 번째 공적분 관계가 (*계속*)

#### 예제 2.7 (계속)

"가장 강할" 것으로 예상해야 한다. 즉, 평균 회귀의 반감기가 가장 짧다. 당연히 이 고유벡터를 선택하여 정상 포트폴리오를 형성하고(고유벡터가 각 ETF의 주식 수를 결정함), 이전에 정상 가격 시계열을 다룰 때와 동일한 방법으로 반감기를 찾을 수 있다. 유일한 차이점은 포트폴리오의 순 시장 가치(가격)를 나타내는 T × 1 배열 *yport*를 계산해야 한다는 것이다. 이는 각 ETF의 주식 수에 각 ETF의 주가를 곱한 다음 모든 ETF에 대해 합산한 것과 같다. *yport*는 예제 2.4에서 *y*의 역할을 한다.

```matlab
yport=smartsum(repmat(results.evec(:, 1)', [size(y3, 1) ...
 1]).*y3, 2);
% Find value of lambda and thus the half-life of mean
 % reversion by linear regression fit
ylag=lag(yport, 1); % lag is a function in the jplv7
 % (spatial-econometrics.com) package.
deltaY=yport-ylag;
deltaY(1)=[]; % Regression functions cannot handle the NaN
 % in the first bar of the time series.
ylag(1)=[];
regress_results=ols(deltaY, [ylag ones(size(ylag))]);
halflife=-log(2)/regress_results.beta(1);
```

23일의 반감기는 USD.CAD의 115일보다 상당히 짧으므로, 평균 회귀 거래 전략이 이 트리플렛에 더 잘 작동할 것으로 예상한다.

# 포트폴리오에 대한 선형 평균 회귀 거래 (Linear Mean-Reverting Trading on a Portfolio)

예제 2.7에서 요한센 검정의 "최상의" 고유벡터로 형성된 EWA-EWC-IGE 포트폴리오가 짧은 반감기를 가진다고 결정했다. 이제 이 포트폴리오에 대해 간단한 선형 평균 회귀 전략을 백테스트할 수 있다. 아이디어는 USD.CAD의 이동 평균에서 음의 정규화된 편차(즉, Z-점수)에 비례하는 단위 수를 소유했던 이전과 같다. 여기서도 "단위" 포트폴리오 가격의 음의 Z-점수에 비례하여 포트폴리오 단위를 누적한다. 단위 포트폴리오는 요한센 고유벡터에 의해 결정된 주식 수를 가진 것이다. 단위 포트폴리오의 주가는 뮤추얼 펀드나 ETF의 주가와 같다: 시장 가치와 동일하다. 단위 포트폴리오가 두 상품의 롱 및 숏 포지션만 있을 때, 일반적으로 *스프레드(spread)*라고 한다. (제3장에서 이것을 더 수학적인 형태로 표현한다.)

"선형" 전략이란 투자 단위 수가 Z-점수에 비례한다는 것만 의미하고, 투자의 시장 가치가 비례한다는 것은 아니라는 점에 유의하라.

이 선형 평균 회귀 전략은 적어도 가장 단순한 버전에서는 분명히 실용적인 전략이 아니다. 처음에 필요한 최대 자본을 알 수 없고

#### 예제 2.8: 포트폴리오에 대한 선형 평균 회귀 전략 백테스팅하기 (Example 2.8: Backtesting a Linear Mean-Reverting Strategy on a Portfolio)

*yport*는 앞의 코드 조각에서 계산된 "단위" 포트폴리오의 순 시장 가치를 나타내는 Tx1 배열이다. *numUnits*는 구매하려는 이 단위 포트폴리오의 배수를 나타내는 Tx1 배열이다. (배수는 단위 포트폴리오를 숏하려는 경우 음수이다.) 다른 모든 변수는 이전에 계산된 대로이다. *positions*는 투자한 포트폴리오에서 각 ETF의 포지션(시장 가치)을 나타내는 Tx3 배열이다. (이 코드 조각은 *cointegrationTests.m*의 일부이다.)

```matlab
% Apply a simple linear mean reversion strategy to EWA-EWC-
 % IGE
lookback=round(halflife); % setting lookback to the halflife
 % found above
numUnits =-(yport-movingAvg(yport, lookback))...
 ./movingStd(yport, lookback); % multiples of unit
 % portfolio . movingAvg and movingStd are functions from
 % epchan.com/book2
positions=repmat(numUnits, [1 size(y3, 2)]).*repmat(results. ...
 evec(:, 1)', [size(y3, 1) 1]).*y3;
 % results.evec(:, 1)' is the shares allocation, while
 % positions is the capital (dollar)
 % allocation in each ETF.
pnl=sum(lag(positions, 1).*(y3-lag(y3, 1))./lag(y3, 1), 2);
 % daily P&L of the strategy
ret=pnl./sum(abs(lag(positions, 1)), 2); % return is P&L
 % divided by gross market value of portfolio
```

그림 2.7은 EWA, EWC, IGE의 정상 포트폴리오에 대한 이 선형 평균 회귀 전략의 누적 수익률 곡선을 표시한다. (*계속*)

#### 예제 2.8 (계속)

![](_page_21_Figure_3.jpeg)

** 그림 2.7**EWA-EWC-IGE 정상 포트폴리오에 대한 선형 거래 전략의 누적 수익률

전략에 대해 APR = 12.6%와 샤프 비율 1.4를 얻는다.

가격이 무한소량으로 움직일 때마다 실제로 무한소 수의 주식을 진입하고 청산할 수 없다. 이러한 비실용성에도 불구하고, 이 간단한 선형 전략으로 평균 회귀 가격 시계열을 백테스팅하는 것의 중요성은 전략에 최적화할 매개변수가 없으므로 데이터 스누핑 편향 없이 수익을 추출할 수 있음을 보여준다는 것이다. (룩백조차도 우리의 특정 거래 전략이 아닌 가격 시계열 자체의 속성에 의존하는 수량인 반감기와 같게 설정됨을 기억하라.) 또한, 전략이 지속적으로 포지션에 진입하고 청산하므로, 더 복잡하고 선택적인 진입 및 청산 규칙을 가진 다른 거래 전략보다 통계적 유의성이 더 높을 가능성이 있다.

# 평균 회귀 전략의 장단점 (Pros and Cons of Mean-Reverting Strategies)

평균 회귀 전략을 구축하는 것은 종종 상당히 쉽다. 왜냐하면 본질적으로 정상인 상품만 거래하는 데 국한되지 않기 때문이다. 우리는 다양한 공적분 주식과 ETF 중에서 선택하여 자체 정상, 평균 회귀 포트폴리오를 만들 수 있다. 매년 기존 것과 약간만 다를 수 있는 새로운 ETF가 생성된다는 사실도 분명히 우리의 목적에 도움이 된다.

풍부한 선택지 외에도, 평균 회귀 페어 뒤에는 종종 좋은 펀더멘털 스토리가 있다. 왜 EWA가 EWC와 공적분할까? 캐나다와 호주 경제 모두 원자재가 지배하기 때문이다. 왜 GDX가 GLD와 공적분할까? 금광 회사의 가치가 금의 가치에 크게 기반하기 때문이다. 공적분 페어가 무너질 때(공적분을 멈출 때)도 종종 그 이유를 이해할 수 있다. 예를 들어, 제4장에서 설명하듯이 GDX와 GLD가 2008년 초에 무너진 이유는 높은 에너지 가격이 금 채굴을 비정상적으로 비싸게 만들었기 때문이다. 이해가 되면 해결책도 나오기를 희망한다. 이러한 펀더멘털 추론의 가용성은 유일한 정당화가 뉴스에 대해 우리보다 느리게 반응하는 투자자가 있다는 것인 많은 모멘텀 전략과 대조된다. 더 노골적으로 말하면, 저 밖에 더 큰 바보들이 있다고 믿어야 한다. 그러나 그 바보들도 결국 우리를 따라잡고, 해당 모멘텀 전략은 어느 날 설명 없이 그냥 작동을 멈출 수 있다.

평균 회귀 전략의 또 다른 장점은 매우 다양한 시간 척도에 걸쳐 있다는 것이다. 한쪽 극단에서 마켓 메이킹 전략은 몇 초 안에 평균 회귀하는 가격에 의존한다. 다른 쪽 극단에서 펀더멘털 투자자들은 저평가된 주식에 수년간 투자하고 가격이 "공정" 가치로 회귀할 때까지 인내심 있게 기다린다. 시간 척도의 짧은 쪽은 우리 같은 트레이더에게 특히 유리하다. 짧은 시간 척도는 연간 더 많은 거래 횟수를 의미하고, 이는 백테스트와 라이브 거래에 대한 더 높은 통계적 신뢰도와 더 높은 샤프 비율, 그리고 궁극적으로 전략의 더 높은 복리 수익률로 이어지기 때문이다.

불행히도, 평균 회귀 전략의 겉보기에 높은 일관성 때문에 결국 몰락으로 이어질 수 있다. 마이클 데버(Michael Dever)가 지적했듯이, 이 높은 일관성은 종종 트레이더들을 과신과 그 결과로 과도한 레버리지에 빠지게 한다(Dever, 2011). (롱텀캐피털매니지먼트(Long Term Capital Management)를 생각해 보라.) 평균 회귀 전략이 갑자기 무너질 때, 아마도 사후에만 식별할 수 있는 펀더멘털 이유 때문에, 이는 종종 끊기지 않은 성공의 연속 후에 최대 레버리지로 거래하고 있을 때 발생한다. 따라서 드문 손실은 종종 매우 고통스럽고 때로는 치명적이다. 따라서 평균 회귀에 대한 리스크 관리가 특히 중요하고, 일반적인 손절매를 논리적으로 배치할 수 없기 때문에 특히 어렵다. 제8장에서 이것이 왜 그런지, 그리고 평균 회귀 전략에 적합한 리스크 관리 기법을 논의한다.

#### 핵심 포인트 (KEY POINTS)

- 평균 회귀는 가격 변화가 평균 가격과 현재 가격의 차이에 비례함을 의미한다.
- 정상성은 가격이 기하 랜덤 워크보다 느리게 확산됨을 의미한다.
- ADF 검정은 평균 회귀를 검정하도록 설계되었다.
- 허스트 지수와 분산비 검정은 정상성을 검정하도록 설계되었다.
- 평균 회귀의 반감기는 가격 시계열이 평균으로 얼마나 빨리 회귀하는지 측정하며, 이 가격 시계열에 적용할 때 평균 회귀 거래 전략의 수익성이나 샤프 비율의 좋은 예측자이다.
- 여기서 선형 거래 전략이란 우리가 소유하는 단위 포트폴리오의 단위 수 또는 주식 수가 해당 포트폴리오 가격 시계열의 음의 Z-점수에 비례함을 의미한다.
- 두 개 이상의 비정상 가격 시계열을 결합하여 정상 포트폴리오를 형성할 수 있다면, 이 가격 시계열은 공적분이라고 한다.
- 공적분은 CADF 검정 또는 요한센 검정으로 측정할 수 있다.
- 요한센 검정에서 생성된 고유벡터는 입력 가격 시계열에서 정상 포트폴리오를 형성하기 위한 헤지 비율로 사용할 수 있으며, 가장 큰 고유값을 가진 것이 가장 짧은 반감기를 가진 것이다.
