# ch04 Mean Reversion Of Stocks And Etfs

### **[발표자료 PDF 다운로드](./Mean_Reversion_Alpha_Evolution.pdf)**
### **[원본 도서 내용 (한글 번역)](./07_chapter_4_mean_reversion_of_stocks_and_etfs_ko.md)**

## 서문 (Executive Summary)

본 보고서는 주식과 ETF 시장에서 발생하는 평균 회귀 현상과 이를 활용한 주요 트레이딩 전략, 그리고 실제 운용 시 직면하는 기술적 난제들을 분석한다. 핵심 조사 결과는 다음과 같다.

* **주식 페어 트레이딩의 한계**: 개별 주식은 장기적으로 기하급수적 랜덤 워크(Geometric Random Walk)를 따르며, 기업 펀더멘털의 급격한 변화로 인해 과거의 공적분(Cointegration) 관계가 실전(Out-of-sample)에서 유지되지 않는 경우가 많다.
* **ETF 전략의 상대적 우위**: 단일 기업보다 경제적 요인에 더 안정적으로 반응하는 ETF 페어 또는 '트리플렛(Triplet)' 구조를 활용할 경우, 평균 회귀 관계가 더 오래 지속되는 경향이 있다.
* **장중 및 계절적 평균 회귀**: 일간 데이터에서는 포착되지 않는 평균 회귀 현상이 특정 조건(예: Buy-on-Gap) 하의 장중 시간대에는 강하게 나타나며, 이는 패닉 매도와 유동성 요구에 의한 가격 왜곡을 이용한다.
* **횡단면적(Cross-sectional) 접근법**: 개별 가격의 역사적 평균 회귀가 아닌, 바스켓 내 종목 간의 상대적 수익률 반전을 이용하는 횡단면적 전략은 선형적 구조와 높은 달러 중립성을 바탕으로 강력한 성과를 보여준다.

![Figure](unnamed.png)

---

## 1. 주식 페어 트레이딩의 주요 난제

주식 페어 트레이딩은 기관 투자자들이 고안한 초기 알고리즘 전략 중 하나이나, 현대 시장에서는 다음과 같은 이유로 수익을 내기가 점점 어려워지고 있다.

### 1.1 통계적 및 펀더멘털 제약

* **비정상성(Non-stationarity)**: 개별 주식 가격 시계열은 대부분 정상성(Stationarity)을 충족하지 못하며 랜덤 워크를 따른다.
* **공적분의 붕괴**: 동일 산업군(예: 애플 vs 블랙베리)이라 하더라도 경영진의 결정이나 경쟁 상황에 따라 두 기업의 운명이 갈리며, 이는 과거에 형성된 공적분 관계를 순식간에 파괴한다.
* **대수의 법칙 부재**: 수익을 내는 페어보다 펀더멘털이 변해 큰 손실을 내는 페어의 영향력이 더 커지는 경향이 있어, 단순한 포트폴리오 다각화만으로는 해결되지 않는다.

### 1.2 기술적 및 시장 구조적 제약

* **공매도 제약 및 숏 스퀴즈**: 하드 투 보로우(Hard-to-borrow) 종목의 경우, 주가 급등 시 주식 대여자의 상환 요구로 인해 가장 불리한 시점에 포지션을 청산해야 하는 위험이 존재한다.
* **업틱 룰(Uptick Rule)**: 미국 시장의 대안 업틱 룰은 서킷 브레이커 발동 시 숏 시장가 주문을 제한하여 백테스팅과 실전 실행 간의 차이를 발생시킨다.
* **NBBO(최우선 매수/매도 호가) 사이즈 감소**: 고빈도 매매(HFT)와 다크 풀의 확산으로 인해 호가 잔량이 매우 작아졌다(예: AAPL의 NBBO가 100주에 불과한 경우). 대량 주문 시 심각한 슬리피지(Slippage)가 발생하며 실전 수익률을 잠식한다.

---

## 2. ETF 기반 평균 회귀 전략의 확장

ETF는 단일 기업보다 펀더멘털 변화가 완만하여 공적분 관계가 더 안정적으로 유지되는 장점이 있다.

### 2.1 ETF 페어 및 트리플렛(Triplet) 트레이딩

* **안정적 관계**: 호주(EWA)와 캐나다(EWC)와 같은 원자재 기반 국가 ETF 페어는 장기간 공적분 관계를 유지한다.
* **트리플렛 전략**: 금(GLD)과 금 채굴 기업(GDX)의 관계가 유가(USO) 급등으로 인해 붕괴되었을 때, 유가를 포함한 세 가지 자산의 공적분(Triplet)을 테스트함으로써 전략의 유효성을 회복할 수 있다. 이는 특정 전략이 작동하지 않을 때 원인을 가설화하고 데이터를 통해 검증하는 '과학적 과정'의 중요성을 시사한다.

### 2.2 지수 차익거래(Index Arbitrage)의 변형

* 전통적인 지수 차익거래는 매우 효율적인 시장이 되어 수익 기회가 거의 없다.
* **대안**: 지수 전체가 아닌, 지수(예: SPY)와 개별적으로 공적분 관계를 맺는 **종목들의 부분 집합(Subset)**을 선택하여 포트폴리오를 구성함으로써 수익 마진을 높일 수 있다.

---

## 3. 장중 계절성: Buy-on-Gap 모델

주가 시계열이 일간 단위로는 랜덤 워크를 따르더라도, 특정 조건 하에서는 강한 계절적 평균 회귀가 발생한다.

### 3.1 전략 로직 및 근거

1. **진입 조건**: 전일 저가 대비 당일 시가가 90일 표준편차의 1배 이상 하락(Gap Down)한 종목 선정.
2. **모멘텀 필터**: 시가가 20일 이동평균선보다 위에 있어야 함. (악재성 뉴스에 의한 하락은 회복 가능성이 낮기 때문)
3. **순위 선정**: 하락 폭이 가장 큰 상위 10개 종목 매수.
4. **청산**: 당일 장 마감 시 전량 매도.

### 3.2 백테스트 결과 (2006년 5월 ~ 2012년 4월)

| 전략 유형 | 연간 수익률 (APR) | 샤프 지수 (Sharpe Ratio) | 특이사항 |
| --- | --- | --- | --- |
| **롱 전용 (Long-only)** | 8.7% | 1.5 | 2009년 이후 수익성 감소 경향 |
| **숏 전용 (Short-only)** | 46% | 1.27 | 높은 수익률이나 가파른 낙폭(Drawdown) 존재 |

---

## 4. 횡단면적(Cross-Sectional) 평균 회귀

횡단면적 전략은 개별 종목의 역사적 가격이 아닌, 바스켓 전체의 평균 수익률에 대한 상대적 이탈과 회귀를 이용한다.

### 4.1 선형 롱-숏 모델 (Khandani and Lo 모델)

이 모델은 각 주식의 자본 배분($w_i$)을 전체 시장 평균 수익률과의 차이에 비례하여 결정한다.

* **공식**: $w_i = -(r_i - <r_j>) / \sum |r_k - <r_j>|$
* **특징**: 매일 동일한 총 자본($1)을 투자하며, 거의 완벽한 달러 중립성을 유지한다. 별도의 매개변수가 없는 선형 모델임에도 불구하고 2008년 금융위기 시기(APR 30%)와 2011년 유럽 부채 위기 시기(APR 11%) 모두 우수한 성과를 보였다.

### 4.2 성과 비교 및 변수 확장

* **종가-종가(Close-to-Close) 모델**: APR 13.7%, 샤프 지수 1.3.
* **시가-종가(Open-to-Close) 모델**: APR 73%, 샤프 지수 4.7. (단, 거래 비용 및 시가 실행 노이즈를 고려하지 않은 수치임)
* **대안 랭킹 변수**: 상대 수익률 외에도 주가수익비율(P/E Ratio)과 같은 펀더멘털 요소를 사용하여 종목을 랭킹하고 평균 회귀를 예측할 수 있다.

---

## 5. 핵심 요약 및 시사점

* **실전 적용의 주의점**: 백테스트 시 생존 편향(Survivorship bias)이 없는 데이터를 사용해야 하며, 거래 비용과 거래소별 체결 가격 차이(Primary vs Consolidated)를 반드시 고려해야 한다.
* **모멘텀 필터의 효용**: 평균 회귀 전략에 모멘텀 필터를 추가하면 악재에 의한 가격 하락과 단순 유동성 수요에 의한 가격 하락을 구분하여 성과의 일관성을 높일 수 있다.
* **실행 전략**: NBBO 사이즈가 작은 현대 시장에서는 시장가 주문보다 한쪽 또는 양쪽 다리에 리밋 오더(Limit order)를 사용하는 정교한 실행 알고리즘이 필수적이다.

---

<div align="center">

[< Previous](../chapter_3_implementing_mean_reversion_strategies/README.md) | [Table of Contents](../README.md) | [Next >](../chapter_5_mean_reversion_of_currencies_and_futures/README.md)

</div>
