변동성 지수를 이용한 미국 주식 시장 방향성 예측: 머신러닝 방법론 비교 분석

요약

이 문서는 변동성 지수가 주식 시장의 미래 방향성을 예측하는 데 얼마나 유용한 정보를 담고 있는지 다양한 머신러닝 방법을 적용하여 분석한 연구 결과를 요약한다. 연구는 2011년 1월부터 2022년 7월까지의 미국 주식 시장 데이터(S&P 500 수익률 및 다수의 변동성 지수)를 사용했다. 주요 분석 결과는 다음과 같다.

* 머신러닝의 우수성: 연구에 사용된 대부분의 머신러닝 모델은 S&P 500 수익률의 방향성을 예측하는 데 있어 전통적인 최소제곱 선형 회귀 모델보다 뛰어난 성능을 보였다.
* 최고 성능 모델: 앙상블 기법인 랜덤 포레스트(Random Forests)와 배깅(Bagging)이 정확도(Accuracy), AUC(Area Under the Curve), F-지표(F-measure) 등 모든 평가 지표에서 가장 높은 예측 성능을 달성했다.
* 특징 선택의 효과: 라쏘(Lasso) 회귀를 통해 예측력이 낮은 변수(VIX9D, VIX3M, VIX6M)를 제거한 후, 모든 모델의 예측 성능이 향상되었다.
* 분류 모델의 강점: 시장의 상승 또는 하락 방향 자체를 예측하는 분류(Classification) 모델이 실제 수익률 값을 예측하는 회귀(Regression) 모델보다 더 우수한 성과를 보였다. 이는 시장 타이밍 결정을 위한 방향성 예측의 실질적 유용성을 시사한다.
* 통계적 유의성: 디볼드-마리아노(Diebold-Mariano) 검정 결과, 랜덤 포레스트와 배깅 모델이 다른 모델들보다 통계적으로 유의미하게 우월함이 확인되었다.

1. 연구 개요

본 연구의 목적은 내재 변동성 지수(implied volatility indices)를 포함한 다양한 시장 위험 지표들이 주식 시장의 미래 방향성 예측에 어떤 정보를 제공하는지 평가하는 것이다. 이를 위해 연구는 전통적인 통계 모델과 여러 머신러닝 방법론의 예측력을 비교 분석했다.

* 연구 대상: 미국 주식 시장(S&P 500)의 향후 30일 수익률 방향성 (상승 또는 하락).
* 핵심 기여:
  * 서로 상충되는 정보를 가질 수 있는 다수의 미래지향적 변동성 지표를 종합적으로 활용.
  * 대규모 데이터 분석 및 변수 선택이 가능한 다양한 머신러닝 기법(분류, 회귀, 앙상블)을 적용하여 예측력을 체계적으로 비교.
  * 기존 연구들이 주로 VIX 지수와 일부 기술적 지표에 국한된 것과 달리, 본 연구는 광범위한 위험 지수들을 포괄하여 분석의 폭을 넓힘.

2. 데이터 및 변수

연구에 사용된 데이터는 블룸버그 데이터베이스에서 추출되었으며, 기간은 2011년 1월부터 2022년 7월까지 총 3040개의 일일 관측치를 포함한다.

* 종속 변수: 향후 30일간의 S&P 500 로그 수익률 (Returns30).
* 예측 변수 (독립 변수): 총 11개의 시장 위험 지표가 사용되었다.
  * VIX 계열 지수:
    * VIX: S&P 500 옵션 가격 기반 30일 기대 변동성.
    * VIX9D: 9일 기대 변동성.
    * VIX3M: 3개월 기대 변동성.
    * VIX6M: 6개월 기대 변동성.
  * 기타 변동성 및 위험 지수:
    * VVIX: VIX 지수 자체의 기대 변동성 (변동성의 변동성).
    * SKEW: S&P 500 수익률의 30일 기대 왜도(skewness). 100 이상이면 부정적 수익률 발생 가능성이 높음을 시사.
    * VXN: 나스닥-100 지수의 30일 기대 변동성.
    * RVOL: 과거 30일간의 실현 변동성(realized volatility).
  * 상품(Commodity) 관련 변동성 지수:
    * GVZ: 금(Gold) ETF 옵션 기반 30일 기대 변동성.
    * OVX: 원유(Crude Oil) ETF 옵션 기반 30일 기대 변동성.
  * 옵션 시장 심리 지표:
    * PUTCALL: S&P 500 지수에 대한 풋옵션과 콜옵션의 거래 비율.

모든 변수는 ADF 단위근 검정을 통해 정상성(stationarity)을 갖는 것으로 확인되었으며, 머신러닝 모델 적용 전 표준화(standardization) 과정을 거쳤다.

3. 연구 방법론

연구는 시장 수익률 예측 문제를 **분류(Classification)**와 회귀(Regression) 두 가지 접근 방식으로 설정하고, 다양한 머신러닝 모델을 적용했다.

* 분류 문제: 시장이 향후 30일 동안 강세(수익률 양수)일지 약세(수익률 음수)일지를 예측하는 이진 분류.
  * 로지스틱 회귀 (Logistic Regression)
  * 선형 판별 분석 (Linear Discriminant Analysis, LDA)
* 회귀 문제: 향후 30일간의 S&P 500 수익률 값을 직접 예측.
  * 릿지 회귀 (Ridge Regression)
  * 라쏘 회귀 (Lasso Regression)
* 앙상블 기법 (분류 및 회귀 공통 적용):
  * 배깅 (Bagging)
  * 랜덤 포레스트 (Random Forests)
  * 그래디언트 부스팅 (Gradient Boosting)

모델의 과적합을 방지하고 최적의 하이퍼파라미터를 찾기 위해, 2128개의 관측치를 고정된 창(window)으로 사용하는 워크-포워드 검증(walk-forward validation) 방식을 채택하여 총 883개의 예측치를 생성했다.

4. 특징 선택 (Feature Selection)

예측 변수들 간의 높은 상관관계(다중공선성) 문제를 해결하고 모델의 해석 가능성을 높이기 위해 라쏘 회귀를 이용한 특징 선택을 수행했다.

* 라쏘 회귀 분석 결과: VIX, VXN, GVZ, OVX 등이 S&P 500 수익률 예측에 중요한 변수로 나타났다.
* 제외된 변수: 라쏘 모델에서 중요도가 0으로 산출된 VIX9D, VIX3M, VIX6M 세 가지 변수는 예측력이 거의 없는 것으로 판단되어 이후 분석에서 제외되었다.
* 다중공선성 완화: 모든 변수를 포함한 선형 회귀 모델(LR1)에서는 VIF(분산 팽창 계수) 값이 매우 높은 변수들이 있었으나, 중요도 0인 변수들을 제거한 모델(LR2)에서는 VIF 값이 크게 감소하여 다중공선성 문제가 완화됨을 확인했다.

변수	LR1 (모든 변수) VIF	LR2 (특징 선택 후) VIF
VIX	149.966	22.613
VVIX	3.126	3.106
SKEW	1.610	1.483
GVZ	2.675	2.267
OVX	2.609	2.397
PUTCALL	1.394	1.312
VXN	17.495	14.459
RVOL	4.863	4.256
VIX9D	40.845	-
VIX6M	104.862	-
VIX3M	289.587	-

5. 예측 성능 평가 및 결과

모델들의 예측 성능은 정확도(ACC), AUC, F-지표 세 가지 기준으로 평가되었다. 평가는 특징 선택 전과 후로 나누어 비교되었다.

5.1. 특징 선택 후 성능 비교

특징 선택을 통해 예측력이 낮은 변수들을 제거한 후 모든 모델의 성능이 향상되었다.

분류 모델 성능 (특징 선택 후) | ML 방법 | 정확도 (ACC) | AUC | F-지표 (F) | | :--- | :--- | :--- | :--- | | 로지스틱 회귀 | 0.6776 | 0.6365 | 0.8076 | | LDA | 0.6776 | 0.6365 | 0.8076 | | 랜덤 포레스트 | 0.8239 | 0.8495 | 0.8828 | | 배깅 | 0.8275 | 0.8493 | 0.8845 | | 그래디언트 부스팅 | 0.7113 | 0.7187 | 0.8215 |

회귀 모델 성능 (특징 선택 후) | ML 방법 | 정확도 (ACC) | AUC | F-지표 (F) | | :--- | :--- | :--- | :--- | | 선형 회귀 (벤치마크) | 0.6373 | 0.6042 | 0.7614 | | 랜덤 포레스트 | 0.8003 | 0.8412 | 0.8592 | | 배깅 | 0.7958 | 0.8370 | 0.8500 | | 그래디언트 부스팅 | 0.6854 | 0.6999 | 0.7694 | | 릿지 회귀 | 0.6080 | 0.5595 | 0.7212 | | 라쏘 회귀 | 0.6178 | 0.5800 | 0.7465 |

* 핵심 결과:
  * 최고 성능: 분류 모델 중에서는 배깅이, 회귀 모델 중에서는 랜덤 포레스트가 가장 높은 성능을 기록했다.
  * 분류 모델 우위: 전반적으로 시장 방향성을 직접 예측하는 분류 모델들이 수익률 값을 예측한 후 이진 변수로 변환한 회귀 모델들보다 더 나은 성과를 보였다.
  * 머신러닝의 압도적 성능: 대부분의 머신러닝 모델, 특히 앙상블 기법들은 전통적인 선형 회귀 모델보다 월등히 높은 예측 정확도를 달성했다.

5.2. 예측 성능 차이의 통계적 유의성

디볼드-마리아노(DM) 검정을 통해 모델 간 예측 오차의 차이가 통계적으로 유의미한지 확인했다.

* 분류 모델: 랜덤 포레스트와 배깅은 서로 통계적으로 구별되지 않는 최상위 성능 그룹을 형성했으며, 로지스틱 회귀 및 LDA보다 유의하게 우수했다.
* 회귀 모델: 랜덤 포레스트와 배깅은 여기서도 가장 우수한 성능 그룹을 형성했으며, 선형 회귀, 라쏘 회귀, 릿지 회귀보다 통계적으로 유의하게 뛰어났다.
* 종합 평가: DM 검정 결과는 모든 모델 중에서 랜덤 포레스트와 배깅이 가장 강력한 예측력을 가졌다는 결론을 뒷받침한다.

6. 결론

본 연구는 변동성 지수가 미국 주식 시장의 방향성을 예측하는 데 매우 유용한 정보를 포함하고 있으며, 특히 머신러닝 방법론을 통해 그 예측력을 극대화할 수 있음을 입증했다.

* 최적의 방법론: 앙상블 기법인 랜덤 포레스트와 배깅이 가장 신뢰할 수 있는 예측 모델로 확인되었다.
* 실무적 시사점: 투자자나 리스크 관리자는 단순히 수익률 값을 예측하기보다, 시장의 상승/하락 방향성 자체를 예측하는 분류 모델을 활용하는 것이 시장 타이밍 전략 수립에 더 효과적일 수 있다.
* 특징 선택의 중요성: 다수의 예측 변수를 사용할 때, 라쏘 회귀와 같은 기법을 통해 정보력이 낮은 변수를 제거하는 과정은 모델의 예측 성능을 향상시키는 데 필수적이다.

결론적으로, 이 연구는 변동성 지수와 최신 머신러닝 기법의 결합이 금융 시장 예측의 정확성을 높이는 강력한 도구가 될 수 있음을 보여준다.
